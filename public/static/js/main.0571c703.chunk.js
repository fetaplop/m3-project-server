(this["webpackJsonpreact-auth-client"]=this["webpackJsonpreact-auth-client"]||[]).push([[0],{31:function(e,t,n){e.exports=n(59)},36:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(29),s=n.n(r),u=n(5),l=n(1),i=n(2),c=n(7),h=n(6),p=(n(36),n(3)),m=n(12),d=n.n(m),g=new(function(){function e(){Object(l.a)(this,e),this.auth=d.a.create({baseURL:"https://oulu-bus-stops.herokuapp.com",withCredentials:!0})}return Object(i.a)(e,[{key:"signup",value:function(e){var t=e.username,n=e.password;return this.auth.post("/auth/signup",{username:t,password:n}).then((function(e){return e.data}))}},{key:"login",value:function(e){var t=e.username,n=e.password;return this.auth.post("/auth/login",{username:t,password:n}).then((function(e){return e.data}))}},{key:"logout",value:function(){return this.auth.get("/auth/logout",{}).then((function(e){return e.data}))}},{key:"me",value:function(){return this.auth.get("/auth/me").then((function(e){return e.data}))}}]),e}()),v=new(function(){function e(){Object(l.a)(this,e),this.user=d.a.create({baseURL:"https://oulu-bus-stops.herokuapp.com",withCredentials:!0})}return Object(i.a)(e,[{key:"favourites",value:function(){return this.user.get("/user/favourites").then((function(e){return e.data}))}},{key:"delete",value:function(){return this.user.delete("user/delete").then((function(e){return e.data}))}}]),e}()),f=o.a.createContext(),b=f.Consumer,E=f.Provider;function y(e){return function(t){return o.a.createElement(b,null,(function(n){return o.a.createElement(e,Object.assign({},t,{user:n.user,isLoggedIn:n.isLoggedIn,isLoading:n.isLoading,login:n.login,signup:n.signup,logout:n.logout,deleteUser:n.deleteUser}))}))}}var L=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={user:null,isLoggedIn:!1,isLoading:!0},e.login=function(t,n){g.login({username:t,password:n}).then((function(t){e.setState({isLoggedIn:!0,isLoading:!1,user:t})})).catch((function(t){console.log(t),e.setState({isLoggedIn:!1,isLoading:!1,user:null})}))},e.signup=function(t,n){g.signup({username:t,password:n}).then((function(t){e.setState({isLoggedIn:!0,isLoading:!1,user:t})})).catch((function(t){console.log(t),e.setState({isLoggedIn:!1,isLoading:!1,user:null})}))},e.logout=function(){g.logout().then((function(){e.setState({isLoggedIn:!1,isLoading:!1,user:null})})).catch((function(e){return console.log(e)}))},e.deleteUser=function(){v.delete().then((function(){e.setState({isLoggedIn:!1,isLoading:!1,user:null})})).catch((function(e){console.log(e)}))},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;g.me().then((function(t){e.setState({isLoggedIn:!0,isLoading:!1,user:t})})).catch((function(t){return e.setState({isLoggedIn:!1,isLoading:!1,user:null})}))}},{key:"render",value:function(){var e=this.state,t=e.user,n=e.isLoggedIn,a=e.isLoading,r=this.login,s=this.signup,u=this.logout,l=this.deleteUser;return o.a.createElement(E,{value:{user:t,isLoggedIn:n,isLoading:a,login:r,signup:s,logout:u,deleteUser:l}},this.props.children)}}]),n}(o.a.Component),k=y(function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.user!==e.user}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.logout,a=e.isLoggedIn;return o.a.createElement("nav",{className:"navbar"},o.a.createElement(u.b,{to:"/",id:"home-btn"},o.a.createElement("h4",null,"Search for stops")),a?o.a.createElement("div",null,o.a.createElement("p",null,t.username),o.a.createElement("button",{onClick:n}," Logout "),o.a.createElement("br",null),o.a.createElement(u.b,{to:"/private"}," ",o.a.createElement("button",{className:"navbar-button"},"My Page")," ")):o.a.createElement(o.a.Fragment,null,o.a.createElement(u.b,{to:"/login"}," ",o.a.createElement("button",{className:"navbar-button"},"Login")," "),o.a.createElement("br",null),o.a.createElement(u.b,{to:"/signup"}," ",o.a.createElement("button",{className:"navbar-button"},"Sign Up")," ")))}}]),n}(a.Component)),O=new(function(){function e(){Object(l.a)(this,e),this.stop=d.a.create({baseURL:"https://oulu-bus-stops.herokuapp.com",withCredentials:!0})}return Object(i.a)(e,[{key:"getAll",value:function(){return this.stop.get("/stops").then((function(e){return e.data}))}},{key:"getOne",value:function(e){return this.stop.get("/stops/".concat(e)).then((function(e){return e.data}))}},{key:"save",value:function(e){return this.stop.post("/stops/".concat(e,"/save")).then((function(e){return e.data}))}},{key:"unsave",value:function(e){return this.stop.post("/stops/".concat(e,"/unsave")).then((function(e){return e.data}))}}]),e}()),j=y(function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={stop:{},isFave:null},e.handleLike=function(){var t=e.state.stop._id;console.log("stopID",t),!1===e.state.isFave&&O.save(t).then((function(t){console.log("saved from handleLike()",t),e.setState({isFave:!0})})),!0===e.state.isFave&&O.unsave(t).then((function(t){console.log("unsaved this stop from handleLike()",t),e.setState({isFave:!1})}))},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;console.log("id from componentDidMount:",t),O.getOne(t).then((function(n){console.log("stopfromServer inside StopPage compoenntDid*Mount:",n),e.setState({stop:n}),v.favourites().then((function(a){console.log("userFavourites",a),console.log("stopFromServer inside userFavourties, ",n);var o=!1;a.length>0&&a.forEach((function(e){console.log("the type of "+e._id+" is: "+typeof e._id),console.log("the id from componentdid mountis this? ",t),e._id===t&&(console.log("we found a match"),o=!0)})),console.log("fave before setting state",o),e.setState({isFave:o,stop:n})})).catch((function(e){console.log("error from trying to update user likes, likely because we are not logged in",e)}))})).catch((function(e){console.log("err from StopService.GetOne in componentDidmount",e)}))}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.isFave!==t.isFave}},{key:"render",value:function(){console.log("this.props.user from render",this.props.user);var e=this.state.stop;return console.log("mystop in render comign from this.state",e),console.log("this.state",this.state),o.a.createElement("div",null,o.a.createElement("h1",null,e.name),o.a.createElement("p",null,"buses servicing this stop: "," "),this.props.isLoggedIn?this.state.isFave?o.a.createElement("button",{onClick:this.handleLike,style:{backgroundColor:"green"}},"is mah fave, unlike?"):o.a.createElement("button",{onClick:this.handleLike,style:{backgroundColor:"red"}},"not fave, wanna save? "):o.a.createElement("p",null,"Log in to save this stop to favourites "))}}]),n}(a.Component)),w=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={data:[],searchFor:"",searchResults:[]},e.search=function(t){var n=e.state.data.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())}));e.setState({searchResults:n})},e.handleSearchInput=function(t){var n=t.target.value;e.setState({searchFor:n},(function(){e.search(n)}))},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;O.getAll().then((function(t){console.log("serverData with stopService getAll me:",t),e.setState({data:t})})).catch((function(e){return console.log("error while getting data from server",e)}))}},{key:"render",value:function(){var e=this.state.searchResults;return o.a.createElement("div",null,o.a.createElement("label",null,"Search: "),o.a.createElement("input",{type:"text",value:this.state.searchFor,onChange:this.handleSearchInput,placeholder:"Search for stops"}),o.a.createElement("div",null,o.a.createElement("p",null,"trying to display search results here:"),e.map((function(e){return o.a.createElement("div",{key:e.stopCode},o.a.createElement(u.b,{to:"/stops/".concat(e._id)},o.a.createElement("h4",null,e.name)))}))))}}]),n}(a.Component);var S=function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Home Page"),o.a.createElement(w,null))},C=n(15),F=y(function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={username:"",password:""},e.handleFormSubmit=function(t){t.preventDefault();var n=e.state,a=n.username,o=n.password;e.props.signup(a,o)},e.handleChange=function(t){var n=t.target,a=n.name,o=n.value;e.setState(Object(C.a)({},a,o))},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.password;return o.a.createElement("div",null,o.a.createElement("h1",null,"Sign Up"),o.a.createElement("form",{onSubmit:this.handleFormSubmit},o.a.createElement("label",null,"Username:"),o.a.createElement("input",{type:"text",name:"username",value:t,onChange:this.handleChange}),o.a.createElement("label",null,"Password:"),o.a.createElement("input",{type:"password",name:"password",value:n,onChange:this.handleChange}),o.a.createElement("input",{type:"submit",value:"Signup"})),o.a.createElement("p",null,"Already have account?"),o.a.createElement(u.b,{to:"/login"}," Login"))}}]),n}(a.Component)),I=y(function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={username:"",password:""},e.handleFormSubmit=function(t){t.preventDefault();var n=e.state,a=n.username,o=n.password;e.props.login(a,o)},e.handleChange=function(t){var n=t.target,a=n.name,o=n.value;e.setState(Object(C.a)({},a,o))},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.password;return o.a.createElement("div",null,o.a.createElement("h1",null,"Login"),o.a.createElement("form",{onSubmit:this.handleFormSubmit},o.a.createElement("label",null,"Username:"),o.a.createElement("input",{type:"text",name:"username",value:t,onChange:this.handleChange}),o.a.createElement("label",null,"Password:"),o.a.createElement("input",{type:"password",name:"password",value:n,onChange:this.handleChange}),o.a.createElement("input",{type:"submit",value:"Login"})))}}]),n}(a.Component));var U=y(function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={userFaves:null},e}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;v.favourites().then((function(t){console.log("got this array of bus stops from server:",t),e.setState({userFaves:t})}))}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Private Route, display my favourite stops here"),this.props.isLoggedIn?o.a.createElement("h3",null,"Username: ",this.props.user.username):null,null!==this.state.userFaves?this.state.userFaves.map((function(e){return o.a.createElement("div",{key:e.stopCode},o.a.createElement(u.b,{to:"/stops/".concat(e._id)}," ",e.name,", code ",e.stopCode," "))})):null,this.props.isLoggedIn?o.a.createElement("button",{onClick:this.props.deleteUser}," Delete user?"):null)}}]),n}(a.Component));var x=y((function(e){console.log("props :>> ",e);var t=e.exact,n=e.path,a=e.component,r=e.isLoggedIn,s=a;return o.a.createElement(p.b,{exact:t,path:n,render:function(e){return r?o.a.createElement(p.a,{to:"/private"}):r?void 0:o.a.createElement(s,e)}})}));var D=y((function(e){console.log("props :>> ",e);var t=e.exact,n=e.path,a=e.component,r=e.isLoggedIn,s=a;return o.a.createElement(p.b,{exact:t,path:n,render:function(e){return r?o.a.createElement(s,e):r?void 0:o.a.createElement(p.a,{to:"/login"})}})})),A=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"container"},o.a.createElement(k,null),o.a.createElement(p.d,null,o.a.createElement(p.b,{exact:!0,path:"/",component:S}),o.a.createElement(x,{exact:!0,path:"/signup",component:F}),o.a.createElement(x,{exact:!0,path:"/login",component:I}),o.a.createElement(p.b,{exact:!0,path:"/stops/:id",component:j}),o.a.createElement(D,{exact:!0,path:"/private",component:U})))}}]),n}(a.Component);s.a.render(o.a.createElement(u.a,null,o.a.createElement(L,null,o.a.createElement(A,null))),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.0571c703.chunk.js.map